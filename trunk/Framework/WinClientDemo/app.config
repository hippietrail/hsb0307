<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <section name="securityConfiguration" type="Microsoft.Practices.EnterpriseLibrary.Security.Configuration.SecuritySettings, Microsoft.Practices.EnterpriseLibrary.Security, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null" />
    <section name="dataConfiguration" type="Microsoft.Practices.EnterpriseLibrary.Data.Configuration.DatabaseSettings, Microsoft.Practices.EnterpriseLibrary.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null" />
    <section name="cachingConfiguration" type="Microsoft.Practices.EnterpriseLibrary.Caching.Configuration.CacheManagerSettings, Microsoft.Practices.EnterpriseLibrary.Caching, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null" />
  </configSections>
  <!-- Security Application Block -->
  <securityConfiguration defaultAuthorizationInstance="DbRuleProvider" defaultSecurityCacheInstance="Caching Store Provider">
    <authorizationProviders>
      <add database="SecurityDemoConnectionString" type="Microsoft.Practices.EnterpriseLibrary.Security.AuthorizationRuleDbProvider, Husb.Security, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" name="DbRuleProvider" />
      <add type="Microsoft.Practices.EnterpriseLibrary.Security.AuthorizationRuleProvider, Microsoft.Practices.EnterpriseLibrary.Security, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null" name="RuleProvider">
        <rules>
          <add expression="R:Roles" name="Rule" />
          <add expression="R:Role2" name="Rule1" />
        </rules>
      </add>
    </authorizationProviders>
    <securityCacheProviders>
      <add cacheManagerInstanceName="Cache Manager" defaultSlidingSessionExpirationInMinutes="10" defaultAbsoluteSessionExpirationInMinutes="60" type="Microsoft.Practices.EnterpriseLibrary.Security.Cache.CachingStore.CachingStoreProvider, Microsoft.Practices.EnterpriseLibrary.Security.Cache.CachingStore, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null" name="Caching Store Provider" />
    </securityCacheProviders>
  </securityConfiguration>
  <!-- Data Access Application Block -->
  <dataConfiguration defaultDatabase="SecurityDemoConnectionString" />
  <connectionStrings>
    <add name="SecurityDemoConnectionString" connectionString="Data Source=.\sqlexpress;Initial Catalog=SecurityDemo;Persist Security Info=True;User ID=sa;Password=sa" providerName="System.Data.SqlClient" />
  </connectionStrings>
  <!-- Caching Application Block -->
  <cachingConfiguration defaultCacheManager="Cache Manager">
    <cacheManagers>
      <add expirationPollFrequencyInSeconds="60" maximumElementsInCacheBeforeScavenging="1000" numberToRemoveWhenScavenging="10" backingStoreName="Null Storage" type="Microsoft.Practices.EnterpriseLibrary.Caching.CacheManager, Microsoft.Practices.EnterpriseLibrary.Caching, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null" name="Cache Manager" />
    </cacheManagers>
    <backingStores>
      <add encryptionProviderName="" type="Microsoft.Practices.EnterpriseLibrary.Caching.BackingStoreImplementations.NullBackingStore, Microsoft.Practices.EnterpriseLibrary.Caching, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null" name="Null Storage" />
    </backingStores>
  </cachingConfiguration>
  <system.web>
    
    <!-- MembershipProvider  RoleProvider -->
    <membership defaultProvider="AdvMembershipProvider">
      <providers>
        <remove name="AspNetSqlMembershipProvider"/>
        <add name="AdvMembershipProvider" type="Husb.Security.GenericMembershipProvider, Husb.Security, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" connectionStringName="SecurityDemoConnectionString" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="true" 
             applicationName="SecurityDemo" requiresUniqueEmail="false" passwordFormat="Hashed" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="1" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" passwordStrengthRegularExpression=""/>
      </providers>
    </membership>
    <roleManager defaultProvider="AdvtzRoleProvider" enabled="true">
      <providers>
        <remove name="AspNetSqlRoleProvider"/>
        <add name="AdvtzRoleProvider" connectionStringName="SecurityDemoConnectionString" 
             applicationName="SecurityDemo" type="Husb.Security.GenericRoleProvider, Husb.Security, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"/>
      </providers>
    </roleManager>
    
  </system.web>
</configuration>